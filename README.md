# Веб-приложение для определения соответствующих шаблонов форм

## Обзор
Этот проект представляет собой веб-приложение на основе Flask, предназначенное для определения наиболее подходящего шаблона формы для заданного набора входных полей. Если соответствующий шаблон не найден, приложение динамически определяет типы полей и возвращает их пользователю.

Проект использует TinyDB для хранения шаблонов форм и включает в себя комплексный скрипт для тестирования приложения в различных сценариях.

## Функции
- **Сопоставление шаблонов форм**: Сопоставляет входные данные с предопределёнными шаблонами, хранящимися в базе данных TinyDB.
- **Проверка полей**: Поддерживает типы полей Email, Phone, Date и Text с проверкой форматов.
- **Ответ по умолчанию**: Возвращает обнаруженные типы полей, если соответствующий шаблон не найден.
- **Скрипт тестирования**: Автоматизирует тестирование приложения в различных сценариях ввода.
- **Виртуальное окружение**: Обеспечивает чистое и изолированное управление зависимостями.

## Requirements
- Python 3.6+
- Flask
- TinyDB
- Requests (для тестирования)

## Инструкции по установке

### Шаг 1: Клонируйте репозиторий
```bash
git clone <repository-url>
cd <repository-folder>
```

### Шаг 2: Создайте и активируйте виртуальное окружение
#### Создание виртуального окружения:
```bash
python -m venv venv
```

#### Активация виртуального окружения:
- macOS/Linux:
  ```bash
  source venv/bin/activate
  ```
- Windows:
  ```bash
  venv\Scripts\activate
  ```

### Шаг 3: Установите зависимости
Установите необходимые библиотеки в виртуальное окружение:
```bash
pip install -r requirements.txt
```

### Шаг 4: Запустите сервер
1. Откройте первый терминал и перейдите в папку проекта.
2. Активируйте виртуальное окружение:
   - macOS/Linux:
     ```bash
     source venv/bin/activate
     ```
   - Windows:
     ```bash
     venv\Scripts\activate
     ```
3. Запустите сервер:
   ```bash
   python main.py
   ```

### Шаг 5: Запустите тесты
1. Откройте второй терминал и перейдите в ту же папку проекта.
2. Активируйте виртуальное окружение:
   - macOS/Linux:
     ```bash
     source venv/bin/activate
     ```
   - Windows:
     ```bash
     venv\Scripts\activate
     ```
3. Запустите скрипт тестирования:
   ```bash
   python server_tests.py
   ```
4. Если все тесты пройдены, скрипт выведет:
   ```css
   All tests passed!
   ```

## Ввод и вывод

### Ввод
Отправьте запрос `POST` на эндпоинт `/get_form` с данными формы.

#### Пример ввода:
```bash
POST /get_form
Content-Type: application/x-www-form-urlencoded

user_email=test@example.com&user_phone=+7 123 456 78 90&user_dob=1990-01-01&user_name=randomUsername
```

### Вывод
- **Если найдено соответствие:**
  ```json
  {
      "template_name": "User Registration Form"
  }
  ```
- **Если соответствие не найдено:**
  ```json
  {
      "user_email": "email",
      "user_phone": "phone",
      "user_dob": "date",
      "user_name": "text"
  }
  ```

## Тестирование
Скрипт `server_tests.py` проверяет приложение в различных сценариях, включая:

- **Корректное совпадение формы**: Сопоставляет входные данные с предопределённым шаблоном.
- **Отсутствующие поля**: Обрабатывает случаи, когда данные формы неполные.
- **Дублирующиеся поля**: Обнаруживает дублирующиеся поля и возвращает ошибку.
- **Дополнительные поля**: Обрабатывает лишние поля без влияния на сопоставление.
- **Пустой ввод**: Возвращает пустой ответ при отсутствии данных.
- **Неверные значения полей**: Проверяет некорректные форматы для Email, Phone, Date и т.д.
- **Не-ASCII символы**: Обеспечивает совместимость с вводом Unicode.

#### Как запустить этот скрипт описано выше

## База данных
Приложение использует TinyDB для хранения шаблонов форм. Пример базы данных (`database.json`) включает следующие предопределённые шаблоны:

### Пример шаблонов:
```json
{
    "templates": {
        "1": {
            "name": "User Registration Form",
            "fields": {
                "user_email": "email",
                "user_phone": "phone",
                "user_dob": "date",
                "user_name": "text"
            }
        },
        "2": {
            "name": "Order Form",
            "fields": {
                "order_email": "email",
                "order_phone": "phone",
                "order_date": "date",
                "order_description": "text"
            }
        },
        "3": {
            "name": "Feedback Form",
            "fields": {
                "feedback_email": "email",
                "feedback_date": "date",
                "feedback_message": "text",
                "feedback_phone": "phone"
            }
        }
    }
}
```

## Заметки
- Убедитесь, что сервер запущен перед выполнением скрипта тестирования.
- Тестовую базу данных можно изменить, чтобы добавить дополнительные шаблоны.
- Приложение использует порт `5000` по умолчанию.

## Устранение неполадок
- **Отсутствуют зависимости**: Убедитесь, что вы активировали виртуальное окружение во всех терминалах перед выполнением команд.
- **Порт уже занят**: Если сервер не запускается, проверьте, не занят ли порт `5000` другими процессами.
